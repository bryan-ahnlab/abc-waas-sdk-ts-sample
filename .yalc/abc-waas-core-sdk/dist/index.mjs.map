{"version":3,"sources":["../src/context/AbcWaasContext.ts","../src/context/AbcWaasProvider.tsx","../src/hooks/useAbcWaas.ts","../src/utilities/parser.ts","../src/api/common/secureChannel.ts","../src/api/v2/auth.ts","../src/api/v2/member.ts","../src/api/v2/wallet.ts","../src/hooks/useLogin.ts","../src/hooks/useLogout.ts"],"names":["basicToken","email","token","service","abcAuth","abcWallet","abcUser","secureChannel","loading","error","useState","useCallback"],"mappings":"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","file":"index.mjs","sourcesContent":["// src/context/AbcWaasContext.ts\n\nimport React, { createContext } from \"react\";\nimport type { AbcWaasContextType } from \"@/types/context\";\n\nexport const AbcWaasContext = createContext<AbcWaasContextType | null>(null);\n","// src/context/AbcWaasProvider.tsx\n\nimport React, { ReactNode, useState, useMemo, useCallback } from \"react\";\nimport { AbcWaasContext } from \"@/context/AbcWaasContext\";\nimport type { AbcWaasConfigType } from \"@/types/config\";\n\ninterface Props {\n  config: AbcWaasConfigType;\n  children: ReactNode;\n}\n\nexport const AbcWaasProvider = ({ config, children }: Props) => {\n  const [basicToken, setBasicTokenState] = useState<string | null>(null);\n\n  const [email, setEmailState] = useState<string | null>(null);\n  const [token, setTokenState] = useState<string | null>(null);\n  const [service, setServiceState] = useState<string | null>(null);\n\n  const [abcAuth, setAbcAuthState] = useState<any>(null);\n  const [abcWallet, setAbcWalletState] = useState<any>(null);\n  const [abcUser, setAbcUserState] = useState<any>(null);\n  const [secureChannel, setSecureChannelState] = useState<any>(null);\n\n  const [loading, setLoadingState] = useState<boolean>(false);\n  const [error, setErrorState] = useState<Error | null>(null);\n\n  const setBasicToken = useCallback((basicToken: string | null) => {\n    setBasicTokenState(basicToken);\n  }, []);\n\n  const setEmail = useCallback((email: string | null) => {\n    setEmailState(email);\n  }, []);\n\n  const setToken = useCallback((token: string | null) => {\n    setTokenState(token);\n  }, []);\n\n  const setService = useCallback((service: string | null) => {\n    setServiceState(service);\n  }, []);\n\n  const setAbcAuth = useCallback((abcAuth: any) => {\n    setAbcAuthState(abcAuth);\n  }, []);\n\n  const setAbcWallet = useCallback((abcWallet: any) => {\n    setAbcWalletState(abcWallet);\n  }, []);\n\n  const setAbcUser = useCallback((abcUser: any) => {\n    setAbcUserState(abcUser);\n  }, []);\n\n  const setSecureChannel = useCallback((secureChannel: any) => {\n    setSecureChannelState(secureChannel);\n  }, []);\n\n  const setLoading = useCallback((loading: boolean) => {\n    setLoadingState(loading);\n  }, []);\n\n  const setError = useCallback((error: Error | null) => {\n    setErrorState(error);\n  }, []);\n\n  const abcAuthState = useMemo(\n    () => ({\n      basicToken,\n      setBasicToken,\n      abcAuth,\n      setAbcAuth,\n    }),\n    [basicToken, abcAuth, setBasicToken, setAbcAuth]\n  );\n\n  const abcWalletState = useMemo(\n    () => ({\n      abcWallet,\n      setAbcWallet,\n      abcUser,\n      setAbcUser,\n    }),\n    [abcWallet, abcUser, setAbcWallet, setAbcUser]\n  );\n\n  const abcUserState = useMemo(\n    () => ({\n      email,\n      setEmail,\n      token,\n      setToken,\n      service,\n      setService,\n    }),\n    [email, token, service, setEmail, setToken, setService]\n  );\n\n  const secureChannelState = useMemo(\n    () => ({\n      secureChannel,\n      setSecureChannel,\n    }),\n    [secureChannel, setSecureChannel]\n  );\n\n  const loadingState = useMemo(\n    () => ({\n      loading,\n      setLoading,\n    }),\n    [loading, setLoading]\n  );\n\n  const errorState = useMemo(\n    () => ({\n      error,\n      setError,\n    }),\n    [error, setError]\n  );\n\n  const contextValue = useMemo(\n    () => ({\n      config,\n      ...abcAuthState,\n      ...abcWalletState,\n      ...abcUserState,\n      ...secureChannelState,\n      ...loadingState,\n      ...errorState,\n    }),\n    [\n      config,\n      abcAuthState,\n      abcUserState,\n      abcWalletState,\n      secureChannelState,\n      loadingState,\n      errorState,\n    ]\n  );\n\n  return (\n    <AbcWaasContext.Provider value={contextValue}>\n      {children}\n    </AbcWaasContext.Provider>\n  );\n};\n","// src/hooks/useAbcWaas.ts\n\nimport React, { useContext } from \"react\";\nimport { AbcWaasContext } from \"@/context/AbcWaasContext\";\n\nexport function useAbcWaas() {\n  const context = useContext(AbcWaasContext);\n\n  if (!context) {\n    throw new Error(\"Not found AbcWaasContext\");\n  }\n\n  return context;\n}\n","// src/utilities/parser.ts\n\n/**\n * HTTP 응답을 안전하게 JSON으로 파싱하는 유틸리티 함수\n *\n * 이 함수는 HTTP 응답을 받아서 JSON으로 파싱하고, 다양한 에러 상황을 적절히 처리합니다.\n * 빈 응답 본문, JSON 파싱 실패, HTTP 에러 상태 등 모든 케이스를 처리합니다.\n *\n * @param response - 파싱할 HTTP Response 객체\n * @param label - 에러 메시지에 포함될 라벨 (기본값: \"Unknown Error\")\n * @returns 파싱된 JSON 데이터 또는 null (빈 본문인 경우)\n * @throws {Error} JSON 파싱 실패, HTTP 에러 응답, 또는 빈 본문 에러 시\n *\n * @example\n * ```typescript\n * try {\n *   const response = await fetch('/api/data');\n *   const data = await parseJson(response, 'API 호출');\n *   if (data !== null) {\n *     console.log('성공:', data);\n *   } else {\n *     console.log('빈 응답');\n *   }\n * } catch (error) {\n *   console.error('API 에러:', error.message);\n * }\n * ```\n */\nexport async function parseJson(\n  response: Response,\n  label: string = \"Unknown Error\"\n) {\n  // 응답 본문을 텍스트로 먼저 읽어옵니다\n  // JSON.parse() 전에 텍스트로 변환하는 것이 안전합니다\n  const text = await response.text();\n\n  // 빈 본문 처리\n  // 서버에서 응답 본문 없이 상태 코드만 보내는 경우를 처리합니다\n  if (!text) {\n    if (!response.ok) {\n      // HTTP 에러 상태이면서 빈 본문인 경우\n      // 서버 에러이지만 상세 정보가 없는 상황을 명시합니다\n      throw new Error(`[${label}] Empty response body`);\n    }\n    // 성공 상태이지만 빈 본문인 경우 (예: 204 No Content)\n    // null을 반환하여 호출자가 빈 응답임을 알 수 있도록 합니다\n    return null;\n  }\n\n  let data: any;\n  try {\n    // 텍스트를 JSON으로 파싱 시도\n    // 잘못된 JSON 형식이면 여기서 에러가 발생합니다\n    data = JSON.parse(text);\n  } catch {\n    // JSON 파싱이 실패한 경우\n    // 원본 텍스트를 포함한 에러를 던져서 디버깅에 도움을 줍니다\n    // HTML 에러 페이지나 잘못된 JSON 형식 등을 확인할 수 있습니다\n    throw new Error(`[${label}] ${text}`);\n  }\n\n  // JSON 파싱은 성공했지만 HTTP 상태 코드가 에러인 경우\n  // (예: 400, 401, 403, 404, 500 등)\n  // 서버에서 에러 응답을 JSON 형태로 보낸 경우를 처리합니다\n  if (!response.ok) {\n    // 에러 응답의 JSON 데이터를 보기 좋게 포맷팅하여 에러 메시지에 포함\n    // null, 2는 JSON.stringify의 들여쓰기 옵션입니다\n    throw new Error(`[${label}] ${JSON.stringify(data, null, 2)}`);\n  }\n\n  // 모든 검증을 통과한 경우 성공적으로 파싱된 데이터를 반환\n  return data;\n}\n","// src/api/secureChannel.ts\n\nimport { p256 } from \"@noble/curves/p256\";\nimport { bytesToHex, hexToBytes } from \"@noble/hashes/utils\";\nimport CryptoJS from \"crypto-js\";\nimport qs from \"qs\";\nimport mCache from \"memory-cache\";\nimport { parseJson } from \"@/utilities/parser\";\n\nexport type SecureChannelType = {\n  PrivateKey: string;\n  Message: string;\n  Encrypted: string;\n  ServerPublicKey: string;\n  ChannelID: string;\n  SecretKey: string;\n};\n\ninterface KeyPairType {\n  privateKey: Uint8Array;\n  publicKey: Uint8Array;\n}\n\nconst AES_KEY_LENGTH = 32;\n\nexport async function createSecureChannel(config: {\n  API_WAAS_MYABCWALLET_URL: string;\n  MW_MYABCWALLET_URL: string;\n  CLIENT_ID: string;\n  CLIENT_SECRET: string;\n}): Promise<SecureChannelType> {\n  try {\n    const keyPair = createKeypair();\n    const message = \"AhnLab Blockchain Company\";\n\n    const formData = qs.stringify({\n      pubkey: bytesToHex(keyPair.publicKey),\n      plain: message,\n    });\n\n    const response = await fetch(\n      `${config.API_WAAS_MYABCWALLET_URL}/secure/channel/create`,\n      {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\n        body: formData,\n      }\n    );\n\n    if (!response.ok)\n      throw new Error(`Failed to create secure channel: ${response.status}`);\n    const responseData = await parseJson(response, \"createSecureChannel\");\n\n    const serverPubkey = hexToBytes(responseData.publickey);\n    const shared = p256.getSharedSecret(keyPair.privateKey, serverPubkey);\n    const sharedX = shared.slice(1, 33); // remove prefix (04)\n\n    const secretKey = bytesToHex(sharedX).padStart(64, \"0\");\n\n    const result: SecureChannelType = {\n      ChannelID: responseData.channelid,\n      Encrypted: responseData.encrypted,\n      ServerPublicKey: responseData.publickey,\n      Message: message,\n      PrivateKey: bytesToHex(keyPair.privateKey),\n      SecretKey: secretKey,\n    };\n\n    mCache.put(\n      \"secureChannel\",\n      { data: responseData, keyPair, secretKey },\n      30 * 60 * 1000 // 30 minutes\n    );\n    sessionStorage.setItem(\"secureChannel\", JSON.stringify(result));\n\n    return result;\n  } catch (error: any) {\n    console.error(\"Create Secure Channel Error: \", error);\n    throw error;\n  }\n}\n\nfunction createKeypair(): KeyPairType {\n  const privateKey = p256.utils.randomPrivateKey();\n  const publicKey = p256.getPublicKey(privateKey, false);\n  return { privateKey, publicKey };\n}\n\nexport function encrypt(channel: SecureChannelType, message: string): string {\n  const { block, iv } = getAESCipher(\n    channel.PrivateKey,\n    channel.ServerPublicKey\n  );\n  const enc = CryptoJS.AES.encrypt(\n    CryptoJS.enc.Utf8.parse(message),\n    CryptoJS.enc.Hex.parse(block),\n    {\n      iv: CryptoJS.enc.Hex.parse(iv),\n      mode: CryptoJS.mode.CBC,\n      padding: CryptoJS.pad.Pkcs7,\n    }\n  );\n  return enc.toString();\n}\n\nexport function decrypt(channel: SecureChannelType, encrypted: string): string {\n  const { block, iv } = getAESCipher(\n    channel.PrivateKey,\n    channel.ServerPublicKey\n  );\n  const dec = CryptoJS.AES.decrypt(encrypted, CryptoJS.enc.Hex.parse(block), {\n    iv: CryptoJS.enc.Hex.parse(iv),\n    mode: CryptoJS.mode.CBC,\n    padding: CryptoJS.pad.Pkcs7,\n  });\n  return dec.toString(CryptoJS.enc.Utf8);\n}\n\nexport function verifySecureChannel(channel: SecureChannelType): boolean {\n  try {\n    const decrypted = decrypt(channel, channel.Encrypted);\n    return decrypted === channel.Message;\n  } catch (error: any) {\n    console.error(\"Secure Channel Verify Error: \", error);\n    return false;\n  }\n}\n\nfunction getAESCipher(privateKeyHex: string, publicKeyHex: string) {\n  const privateKey = hexToBytes(privateKeyHex);\n  const publicKey = hexToBytes(publicKeyHex);\n  const shared = p256.getSharedSecret(privateKey, publicKey);\n\n  const key = shared.slice(1, 17); // first 16 bytes\n  const iv = shared.slice(17, 33); // next 16 bytes\n  return { block: bytesToHex(key), iv: bytesToHex(iv) };\n}\n\nexport async function secureChannelScenario(config: {\n  API_WAAS_MYABCWALLET_URL: string;\n  MW_MYABCWALLET_URL: string;\n  CLIENT_ID: string;\n  CLIENT_SECRET: string;\n}) {\n  // Creating Secure Channel\n  const secureChannelRes: SecureChannelType = await createSecureChannel(config);\n  console.log(\"Secure Channel Created: \", secureChannelRes);\n\n  // Verifying Secure Channel\n  const verifyResult: boolean = verifySecureChannel(secureChannelRes);\n  console.log(\"Secure Channel Verify Result: \", verifyResult); // expected to be true\n\n  // Encrypting and decrypting message using Secure Channel\n  const message: string = \"Hello, Bryan!\";\n  const encryptedMessage: string = encrypt(secureChannelRes, message);\n  const decryptedMessage: string = decrypt(secureChannelRes, encryptedMessage);\n\n  console.log(\"Message Encrypt Result: \", message === decryptedMessage); // expected to be true\n}\n\n/**\n * 랜덤 비밀번호 생성\n */\nexport const randomPassword = () => {\n  const chars =\n    \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";\n  let password = \"\";\n  for (let i = 0; i < 8; i++) {\n    const randomIndex = Math.floor(Math.random() * chars.length);\n    password += chars[randomIndex];\n  }\n  return password;\n};\n\n/**\n * 암호화된 비밀번호 생성\n */\nexport const encryptedPassword = (secret: string) => {\n  // 32바이트 키를 생성한 후, 앞 16바이트만 AES 128비트 키로 사용\n  const key = CryptoJS.enc.Hex.parse(secret.substring(0, 32))\n    .toString(CryptoJS.enc.Hex)\n    .substring(0, 32); // 32자리 hex 중 앞의 16바이트만 사용\n  const iv = CryptoJS.enc.Hex.parse(secret.substring(AES_KEY_LENGTH)); // 나머지를 IV로 사용\n\n  // 암호화 수행\n  const encrypted = CryptoJS.AES.encrypt(\n    randomPassword(),\n    CryptoJS.enc.Hex.parse(key),\n    {\n      iv,\n      mode: CryptoJS.mode.CBC,\n      padding: CryptoJS.pad.Pkcs7,\n    }\n  );\n\n  // Base64 형식으로 변환\n  return encrypted.ciphertext.toString(CryptoJS.enc.Base64);\n};\n","// src/api/v2/auth.ts\n\nimport { AbcWaasConfigType } from \"@/types/config\";\n\nexport async function postTokenLoginV2(\n  config: AbcWaasConfigType,\n  basicToken: string,\n  token: string,\n  service: string\n) {\n  return fetch(\n    `${config.API_WAAS_MYABCWALLET_URL}/auth/auth-service/v2/token/login`,\n    {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\n        Authorization: `Basic ${basicToken}`,\n      },\n      body: new URLSearchParams({\n        token,\n        service,\n        audience: config.MW_MYABCWALLET_URL,\n      }),\n    }\n  );\n}\n","// src/api/v2/member.ts\n\nimport { AbcWaasConfigType } from \"@/types/config\";\n\nexport async function postMemberJoinV2(\n  config: AbcWaasConfigType,\n  basicToken: string,\n  username: string,\n  code: string,\n  socialtype: string,\n  overage = \"1\",\n  agree = \"1\",\n  collect = \"1\",\n  thirdparty = \"1\",\n  advertise = \"1\"\n) {\n  return fetch(\n    `${config.API_WAAS_MYABCWALLET_URL}/member/user-management/v2/join`,\n    {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\n        Authorization: `Basic ${basicToken}`,\n      },\n      body: new URLSearchParams({\n        username,\n        code,\n        serviceid: config.MW_MYABCWALLET_URL,\n        socialtype,\n        overage,\n        agree,\n        collect,\n        thirdparty,\n        advertise,\n      }),\n    }\n  );\n}\n","// src/api/v2/wallet.ts\n\nimport { AbcWaasConfigType } from \"@/types/config\";\n\nexport async function getMpcWalletsInfoV2(\n  config: AbcWaasConfigType,\n  accessToken: string\n) {\n  return fetch(`${config.API_WAAS_MYABCWALLET_URL}/wapi/v2/mpc/wallets/info`, {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\n      Authorization: `Bearer ${accessToken}`,\n    },\n  });\n}\n\nexport async function postMpcWalletsV2(\n  config: AbcWaasConfigType,\n  accessToken: string,\n  email: string,\n  channelid: string,\n  devicePassword: string\n) {\n  return fetch(`${config.API_WAAS_MYABCWALLET_URL}/wapi/v2/mpc/wallets`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\n      Authorization: `Bearer ${accessToken}`,\n      \"Secure-Channel\": channelid,\n    },\n    body: new URLSearchParams({\n      email,\n      devicePassword,\n    }),\n  });\n}\n","// src/hooks/useLogin.ts\n\nimport React, { useCallback, useState, useEffect } from \"react\";\nimport { useAbcWaas } from \"@/hooks/useAbcWaas\";\nimport {\n  createSecureChannel,\n  encryptedPassword,\n} from \"@/api/common/secureChannel\";\nimport { postTokenLoginV2 } from \"@/api/v2/auth\";\nimport { postMemberJoinV2 } from \"@/api/v2/member\";\nimport { getMpcWalletsInfoV2, postMpcWalletsV2 } from \"@/api/v2/wallet\";\nimport { parseJson } from \"@/utilities/parser\";\nimport { UseLoginStatusType } from \"@/types/hook\";\n\nexport function useLogin() {\n  const {\n    config,\n\n    basicToken,\n    setBasicToken,\n\n    email,\n    setEmail,\n    token,\n    setToken,\n    service,\n    setService,\n\n    abcAuth,\n    setAbcAuth,\n    abcWallet,\n    setAbcWallet,\n    abcUser,\n    setAbcUser,\n    secureChannel,\n    setSecureChannel,\n  } = useAbcWaas();\n\n  const [loading, setLoading] = useState<boolean>(false);\n  const [error, setError] = useState<Error | null>(null);\n  const [status, setStatus] = useState<UseLoginStatusType | null>(null);\n\n  const loginV2 = useCallback(\n    async (email: string, token: string, service: string) => {\n      try {\n        setLoading(true);\n        setError(null);\n        setStatus(\"LOADING\");\n\n        setEmail(email);\n        setToken(token);\n        setService(service);\n\n        const secureChannel = await createSecureChannel(config);\n        setSecureChannel(secureChannel);\n\n        const basicToken = btoa(`${config.CLIENT_ID}:${config.CLIENT_SECRET}`);\n        setBasicToken(basicToken);\n\n        const tryLogin = await postTokenLoginV2(\n          config,\n          basicToken,\n          token,\n          service\n        );\n\n        const tryLoginData = await tryLogin.json(); // { access_token, refresh_token, token_type, expire_in }\n\n        let accessToken = null;\n\n        if (tryLogin.ok) {\n          accessToken = tryLoginData.access_token;\n          setAbcAuth(tryLoginData);\n          sessionStorage.setItem(\"abcAuth\", JSON.stringify(tryLoginData));\n        }\n\n        if (tryLogin.status === 422 && tryLoginData.code === 618) {\n          const {\n            email,\n            sixcode,\n            token: newToken,\n          } = JSON.parse(tryLoginData.msg);\n\n          const joinMember = await postMemberJoinV2(\n            config,\n            basicToken,\n            email,\n            sixcode,\n            service\n          );\n          if (!joinMember?.ok) {\n            setStatus(\"FAILURE\");\n            throw new Error(JSON.stringify(joinMember));\n          }\n\n          const retryLogin = await postTokenLoginV2(\n            config,\n            basicToken,\n            newToken,\n            service\n          );\n          const retryLoginData = await parseJson(\n            retryLogin,\n            \"postTokenLoginV2\"\n          ); // { access_token, refresh_token, token_type, expire_in }\n          if (!retryLogin.ok) {\n            setStatus(\"FAILURE\");\n            throw new Error(JSON.stringify(retryLoginData));\n          }\n\n          accessToken = retryLoginData.access_token;\n          setAbcAuth(retryLoginData);\n          sessionStorage.setItem(\"abcAuth\", JSON.stringify(retryLoginData));\n        } else if (!tryLogin.ok) {\n          setStatus(\"FAILURE\");\n          throw new Error(JSON.stringify(tryLoginData));\n        }\n\n        /*  */\n\n        const channelid = secureChannel.ChannelID;\n        const secretKey = secureChannel.SecretKey;\n\n        const devicePassword = encryptedPassword(secretKey);\n\n        const createMpcWallets = await postMpcWalletsV2(\n          config,\n          accessToken,\n          email,\n          channelid,\n          devicePassword\n        );\n\n        const createMpcWalletsData = await parseJson(\n          createMpcWallets,\n          \"postMpcWalletsV2\"\n        );\n        if (!createMpcWallets.ok) {\n          setStatus(\"FAILURE\");\n          throw new Error(JSON.stringify(createMpcWalletsData));\n        }\n        if (\n          createMpcWalletsData.message ===\n          \"The token was expected to have 3 parts, but got 1.\"\n        ) {\n          setStatus(\"FAILURE\");\n          throw new Error(JSON.stringify(createMpcWalletsData));\n        }\n\n        setAbcWallet(createMpcWalletsData);\n        sessionStorage.setItem(\n          \"abcWallet\",\n          JSON.stringify(createMpcWalletsData)\n        );\n\n        const mpcWalletsInfo = await getMpcWalletsInfoV2(config, accessToken);\n\n        const mpcWalletsInfoData = await parseJson(\n          mpcWalletsInfo,\n          \"getMpcWalletsInfoV2\"\n        );\n        if (!mpcWalletsInfo.ok) {\n          setStatus(\"FAILURE\");\n          throw new Error(JSON.stringify(mpcWalletsInfoData));\n        }\n        if (\n          mpcWalletsInfoData.message ===\n          \"The token was expected to have 3 parts, but got 1.\"\n        ) {\n          setStatus(\"FAILURE\");\n          throw new Error(JSON.stringify(mpcWalletsInfoData));\n        }\n        if (mpcWalletsInfoData.message === \"MPC KeyShare Recover Error\") {\n          setStatus(\"FAILURE\");\n          throw new Error(JSON.stringify(mpcWalletsInfoData));\n        }\n        if (mpcWalletsInfoData.message === \"KeyShare generate failed.\") {\n          setStatus(\"FAILURE\");\n          throw new Error(JSON.stringify(mpcWalletsInfoData));\n        }\n\n        setAbcUser(mpcWalletsInfoData);\n        sessionStorage.setItem(\"abcUser\", JSON.stringify(mpcWalletsInfoData));\n\n        setStatus(\"SUCCESS\");\n        return;\n      } catch (error: any) {\n        setError(error);\n        if (status !== \"FAILURE\") {\n          setStatus(\"FAILURE\");\n        }\n        throw error;\n      } finally {\n        setLoading(false);\n      }\n    },\n    [config, status]\n  );\n\n  return {\n    config,\n\n    basicToken,\n\n    email,\n    token,\n    service,\n\n    abcAuth,\n    abcWallet,\n    abcUser,\n    secureChannel,\n\n    loginV2,\n    loading,\n    setLoading,\n    error,\n    setError,\n    status,\n    setStatus,\n  };\n}\n","// src/hooks/useLogout.ts\n\nimport React, { useCallback, useState } from \"react\";\nimport { useAbcWaas } from \"@/hooks/useAbcWaas\";\nimport { UseLogoutStatusType } from \"@/types/hook\";\n\nexport function useLogout() {\n  const {\n    setBasicToken,\n\n    setEmail,\n    setToken,\n    setService,\n\n    setAbcAuth,\n    setAbcWallet,\n    setAbcUser,\n    setSecureChannel,\n  } = useAbcWaas();\n\n  const [loading, setLoading] = useState<boolean>(false);\n  const [error, setError] = useState<Error | null>(null);\n  const [status, setStatus] = useState<UseLogoutStatusType | null>(null);\n\n  const logoutV2 = useCallback(async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      setStatus(\"LOADING\");\n\n      sessionStorage.removeItem(\"abcAuth\");\n      sessionStorage.removeItem(\"abcWallet\");\n      sessionStorage.removeItem(\"abcUser\");\n      sessionStorage.removeItem(\"secureChannel\");\n\n      setBasicToken(null);\n      setEmail(null);\n      setToken(null);\n      setService(null);\n      setAbcAuth(null);\n      setAbcWallet(null);\n      setAbcUser(null);\n      setSecureChannel(null);\n\n      setStatus(\"SUCCESS\");\n    } catch (error: any) {\n      setError(error);\n      setStatus(\"FAILURE\");\n      throw error;\n    } finally {\n      setLoading(false);\n    }\n  }, [\n    setBasicToken,\n    setEmail,\n    setToken,\n    setService,\n    setAbcAuth,\n    setAbcWallet,\n    setAbcUser,\n    setSecureChannel,\n  ]);\n\n  return {\n    logoutV2,\n\n    loading,\n    setLoading,\n    error,\n    setError,\n    status,\n    setStatus,\n  };\n}\n"]}